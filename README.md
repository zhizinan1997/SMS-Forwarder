# ğŸ“± SMS-Forwarder | DT718H çŸ­ä¿¡è½¬å‘åŠ©æ‰‹

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Docker](https://img.shields.io/badge/Docker-Supported-blue.svg)](https://www.docker.com/)
[![Web UI](https://img.shields.io/badge/UI-iOS--Style-FF3B30.svg)]()

> åŸºäº DT718H 4G æ¨¡ç»„çš„é«˜æ€§èƒ½çŸ­ä¿¡è½¬å‘ç³»ç»Ÿï¼Œæ”¯æŒå¤šæ¸ é“é€šçŸ¥æ¨é€å’Œ iOS ä½“éªŒçš„ Web ç®¡ç†ç•Œé¢ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ sms-device/         # è®¾å¤‡ç«¯ Lua è„šæœ¬ (åˆ·å…¥ DT718H)
â”œâ”€â”€ sms-server/         # Web æœåŠ¡å™¨ (éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨/äº‘å¹³å°)
â”œâ”€â”€ soc/                # LuatOS å›ºä»¶
â”œâ”€â”€ tools/              # åˆ·æœºå·¥å…· (Luatools)
â”œâ”€â”€ FILE_NOTES.md       # é¡¹ç›®ä»£ç å®¡æŸ¥ä¸å„æ–‡ä»¶è¯¦ç»†å¤‡æ³¨
â””â”€â”€ README.md           # æœ¬æ–‡æ¡£
```

---

## ğŸ“¸ ç•Œé¢é¢„è§ˆ

| ğŸ’¬ æ¥æ”¶æ¶ˆæ¯ (iOS é£æ ¼) | ğŸ“¤ å‘é€çŸ­ä¿¡ |
| :---: | :---: |
| ![æ¥æ”¶çŸ­ä¿¡](images/jieshouduanxin.jpg) | ![å‘é€çŸ­ä¿¡](images/fasongxinxi.jpg) |

---

## ğŸ› ï¸ æ¨èç¡¬ä»¶

æœ¬é¡¹ç›®åŸºäº **åˆå®™ Air780E** æ¨¡ç»„å¼€å‘ï¼Œå…·æœ‰æé«˜çš„æ€§ä»·æ¯”å’Œç¨³å®šæ€§ã€‚

| ç¡¬ä»¶å®æ‹ | æ¨èæ–¹æ¡ˆ |
| :---: | :--- |
| ![ç¡¬ä»¶å±•ç¤º](images/device.jpg) | **Air780E ç³»åˆ—å¼€å‘æ¿**<br>Â· 4G å…¨ç½‘é€šç‰©è”ç½‘æ¨¡å—<br>Â· æ”¯æŒ LuatOS äºŒæ¬¡å¼€å‘<br>Â· [ğŸ›’ ç‚¹å‡»å‰å¾€æ·˜å®è´­ä¹°](https://e.tb.cn/h.7gu14ADyoa5Ur7B?tk=B7RefAkj85l) |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½² Web æœåŠ¡å™¨

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ GitHub Container Registry (æ¨è)

```bash
# æ‹‰å–æœ€æ–°é•œåƒ (æ”¯æŒ amd64/arm64)
docker pull ghcr.io/zhizinan1997/sms-forwarder/sms-server:latest

# å¯åŠ¨å®¹å™¨
docker run -d \
  --name sms-server \
  -p 3000:3000 \
  -v $(pwd)/data:/app/data \
  -e TZ=Asia/Shanghai \
  --restart unless-stopped \
  ghcr.io/zhizinan1997/sms-forwarder/sms-server:latest
```

> ğŸ’¡ é•œåƒæ”¯æŒ `linux/amd64` å’Œ `linux/arm64` æ¶æ„ï¼Œå¯åœ¨ x86 æœåŠ¡å™¨æˆ–æ ‘è“æ´¾ç­‰ ARM è®¾å¤‡ä¸Šè¿è¡Œã€‚

#### æ–¹å¼äºŒï¼šäº‘å¹³å° PaaS éƒ¨ç½² (é›¶æˆæœ¬/å…ç»´æŠ¤)

å¦‚æœæ‚¨æ²¡æœ‰è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå¯ä»¥å…ˆ **Fork æœ¬é¡¹ç›®**ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å¹³å°ä¸€é”®éƒ¨ç½²ï¼ˆæ”¯æŒ Docker + SQLite æŒä¹…åŒ– + WebSocketï¼‰ï¼š

##### ğŸŸ£ Zeabur (æœ€æ¨è)

1. åœ¨ [Zeabur](https://zeabur.com/) åˆ›å»ºé¡¹ç›®ï¼Œé€‰æ‹© **"Deploy Service"** â†’ **"GitHub"**ã€‚
2. è®¾ç½® **Root Directory** ä¸º `sms-server`ã€‚
3. **å…³é”®æ­¥éª¤**ï¼šåœ¨æœåŠ¡è®¾ç½®é¢æ¿ä¸­ï¼Œç‚¹å‡» **"Storage"** -> **"Add Volume"**ï¼ŒæŒ‚è½½è·¯å¾„å¡« `/app/data`ã€‚

##### ğŸš‚ Railway

1. åœ¨ [Railway](https://railway.app/) ç‚¹å‡» **"New Project"** â†’ **"Deploy from GitHub repo"**ã€‚
2. åœ¨ **Settings** ä¸­è®¾ç½® **Root Directory** ä¸º `sms-server`ã€‚
3. **å…³é”®æ­¥éª¤**ï¼šç‚¹å‡» **"Add"** -> **"Volume"**ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ° `/app/data`ã€‚

##### â˜ï¸ Render

1. åœ¨ [Render](https://render.com/) åˆ›å»º **"Web Service"**ï¼Œè¿æ¥ GitHub ä»“åº“ã€‚
2. è®¾ç½® **Runtime** ä¸º `Docker`ï¼Œ**Root Directory** ä¸º `sms-server`ã€‚
3. **æ³¨æ„**ï¼šRender å…è´¹ç‰ˆä¸æ”¯æŒæŒä¹…åŒ–å­˜å‚¨ï¼Œå»ºè®®ä½¿ç”¨å…¶ä»˜è´¹ç‰ˆçš„ **"Disk"** åŠŸèƒ½æŒ‚è½½ `/app/data`ã€‚

#### æ–¹å¼ä¸‰ï¼šæœ¬åœ°æ„å»º/å¯¼å…¥é•œåƒ

<details>
<summary>ç‚¹å‡»å±•å¼€æœ¬åœ°æ„å»ºæ­¥éª¤</summary>

```bash
cd sms-server
# ä½¿ç”¨ docker-compose æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

æˆ–è€…æ‰‹å·¥å¯¼å…¥é•œåƒåŒ…ï¼š

```bash
docker load -i sms-server.tar
docker run -d ...
```

</details>

1. è®¿é—® `http://ä½ çš„åŸŸåæˆ–IP:3000`ï¼Œé»˜è®¤å¯†ç ï¼š`admin`ï¼Œç™»é™†åè¯·åŠæ—¶ä¿®æ”¹

### ç¬¬äºŒæ­¥ï¼šåˆ·å…¥è®¾å¤‡è„šæœ¬

1. å®‰è£…åˆ·æœºå·¥å…·ï¼šè¿è¡Œ `tools/Luatools_v3.exe`

2. è¿æ¥ Air780E è®¾å¤‡åˆ°ç”µè„‘ USB

3. åœ¨ Luatools ä¸­ï¼š
   - é€‰æ‹© "é¡¹ç›®ç®¡ç†" â†’ "åˆ›å»ºé¡¹ç›®"
   - é€‰æ‹©åº•å±‚å›ºä»¶ï¼š`soc/LuatOS-SoC_DT718H.soc`
   - æ·»åŠ è„šæœ¬ï¼š`sms-device/` ç›®å½•ä¸‹æ‰€æœ‰ `.lua` æ–‡ä»¶
   - ç‚¹å‡» "ä¸‹è½½" åˆ·å…¥è®¾å¤‡

4. ä¿®æ”¹é…ç½®åé‡æ–°åˆ·å…¥ç”Ÿæ•ˆ

è¯¦ç»†åˆ·æœºæ•™ç¨‹ï¼Œå¯ä»¥å‚è€ƒæœ¬é¡µæœ€åè‡´è°¢éƒ¨åˆ†çš„ [LuatOS åˆ·æœºæ•™ç¨‹](#luatos-åˆ·æœºæ•™ç¨‹)
---

## âš™ï¸ è®¾å¤‡é…ç½®è¯´æ˜

ç¼–è¾‘ `sms-device/config.lua`ï¼š

### é€šçŸ¥æ¸ é“é…ç½®

```lua
-- æ”¯æŒåŒæ—¶é…ç½®å¤šä¸ªæ¸ é“
NOTIFY_TYPE = {"dingtalk", "server"},
```

å¯é€‰æ¸ é“ï¼š`telegram`, `pushdeer`, `bark`, `dingtalk`, `feishu`, `wecom`, `pushover`, `inotify`, `smtp`, `gotify`, `server`

### Web æœåŠ¡å™¨æ¨é€é…ç½®

```lua
SERVER_API = "http://ä½ çš„æœåŠ¡å™¨IP:3000",  -- æœåŠ¡å™¨åœ°å€
DEVICE_ID = "dt718h_01",                  -- è®¾å¤‡æ ‡è¯†ID
SERVER_POLL_INTERVAL = 1000 * 10,          -- è½®è¯¢é—´éš”(æ¯«ç§’), 0=å…³é—­
```

### é’‰é’‰æœºå™¨äººé…ç½®

```lua
DINGTALK_WEBHOOK = "https://oapi.dingtalk.com/robot/send?access_token=xxx",
```

### é£ä¹¦æœºå™¨äººé…ç½®

```lua
FEISHU_WEBHOOK = "https://open.feishu.cn/open-apis/bot/v2/hook/xxx",
```

### ä¼ä¸šå¾®ä¿¡æœºå™¨äººé…ç½®

```lua
WECOM_WEBHOOK = "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx",
```

### Bark æ¨é€é…ç½® (iOS)

```lua
BARK_API = "https://api.day.app",
BARK_KEY = "ä½ çš„key",
```

### SMTP é‚®ä»¶é…ç½®

```lua
SMTP_HOST = "smtp.163.com",
SMTP_PORT = 25,
SMTP_USERNAME = "your@163.com",
SMTP_PASSWORD = "æˆæƒç ",
SMTP_MAIL_FROM = "your@163.com",
SMTP_MAIL_TO = "receive@example.com",
SMTP_MAIL_SUBJECT = "æ¥è‡ª DT718H çš„é€šçŸ¥",
```

### å…¶ä»–è®¾ç½®

```lua
BOOT_NOTIFY = true,              -- å¼€æœºå‘é€é€šçŸ¥
NOTIFY_APPEND_MORE_INFO = true,  -- è¿½åŠ è®¾å¤‡ä¿¡æ¯(IMEIã€ä¿¡å·ç­‰)
NOTIFY_RETRY_MAX = 3,            -- é€šçŸ¥å¤±è´¥é‡è¯•æ¬¡æ•°
LOCATION_INTERVAL = 0,           -- åŸºç«™å®šä½é—´éš”(æ¯«ç§’), 0=å…³é—­
LOW_POWER_MODE = false,          -- ä½åŠŸè€—æ¨¡å¼
```

---

## ğŸ–¥ï¸ Web ç®¡ç†ç•Œé¢

### åŠŸèƒ½ç‰¹æ€§

- ğŸ“± iOS é£æ ¼ UIï¼Œæ”¯æŒæ·±è‰²/æµ…è‰²æ¨¡å¼
- ğŸ”„ WebSocket å®æ—¶æ›´æ–°
- ğŸ’¬ æŸ¥çœ‹çŸ­ä¿¡ä¼šè¯åˆ—è¡¨
- ğŸ“¤ å‘é€çŸ­ä¿¡ï¼ˆè‡ªåŠ¨æ ‡å‡†åŒ–æ‰‹æœºå·æ ¼å¼ï¼‰
- ğŸ”’ å¯†ç ç™»å½•ä¿æŠ¤
- ğŸ“± PWA æ”¯æŒï¼Œå¯æ·»åŠ åˆ°æ‰‹æœºæ¡Œé¢
- ğŸ‘¤ **ç®¡ç†å‘˜æ§åˆ¶å°** - ç‹¬ç«‹çš„ç®¡ç†åå°
- ğŸ”‘ **å­è´¦å·ç³»ç»Ÿ** - æ”¯æŒå¤šç”¨æˆ·ä¸åŒæƒé™è®¿é—®

### ğŸ” ç®¡ç†å‘˜æ§åˆ¶å°

è®¿é—® `/admin.html` è¿›å…¥ç®¡ç†å‘˜æ§åˆ¶å°ã€‚

#### é¦–æ¬¡ä½¿ç”¨

1. é¦–æ¬¡è®¿é—®ä¼šæç¤º**åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å·**
2. è®¾ç½®ç®¡ç†å‘˜ç”¨æˆ·åï¼ˆè‡³å°‘3ä½ï¼‰å’Œå¯†ç ï¼ˆè‡³å°‘4ä½ï¼‰
3. åˆ›å»ºæˆåŠŸåè·³è½¬åˆ°ç™»å½•é¡µé¢

#### ç®¡ç†å‘˜åŠŸèƒ½

- **ä¿®æ”¹å¯†ç ** - æ›´æ–°ç®¡ç†å‘˜ç™»å½•å¯†ç 
- **å­è´¦å·ç®¡ç†** - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å­è´¦å·
- **å¿«æ·å…¥å£** - å¿«é€Ÿè·³è½¬åˆ°çŸ­ä¿¡ç•Œé¢

### ğŸ‘¥ å­è´¦å·ä¸çŸ­ä¿¡ç­›é€‰

å­è´¦å·ç³»ç»Ÿå…è®¸æ‚¨ä¸ºä¸åŒç”¨æˆ·è®¾ç½®ä¸åŒçš„è®¿é—®æƒé™ï¼Œé€šè¿‡**å¯†ç **åŒºåˆ†ç”¨æˆ·ï¼Œæ¯ä¸ªå¯†ç å¯é…ç½®ç‹¬ç«‹çš„**çŸ­ä¿¡ç­›é€‰è§„åˆ™**ã€‚

#### æ·»åŠ å­è´¦å·

åœ¨ç®¡ç†å‘˜æ§åˆ¶å°ç‚¹å‡»ã€Œ+ æ·»åŠ å­è´¦å·ã€ï¼š

| å­—æ®µ | è¯´æ˜ |
|------|------|
| ç™»å½•å¯†ç  | ç”¨æˆ·åœ¨çŸ­ä¿¡ç•Œé¢ç™»å½•æ—¶ä½¿ç”¨çš„å¯†ç ï¼ˆè‡³å°‘4ä½ï¼‰ |
| ç­›é€‰ç±»å‹ | `æ˜¾ç¤ºæ‰€æœ‰çŸ­ä¿¡` / `å†…å®¹åŒ…å«å…³é”®è¯` / `å‘é€è€…åŒ¹é…` |
| ç­›é€‰å…³é”®è¯ | å½“ç­›é€‰ç±»å‹é"å…¨éƒ¨"æ—¶ï¼Œå¡«å†™åŒ¹é…å…³é”®è¯ |
| å¤‡æ³¨è¯´æ˜ | å¯é€‰ï¼Œæ–¹ä¾¿ç®¡ç†å‘˜è¯†åˆ« |

#### ä½¿ç”¨ç¤ºä¾‹

| å¯†ç  | ç­›é€‰ç±»å‹ | ç­›é€‰å€¼ | æ•ˆæœ |
|------|----------|--------|------|
| `666666` | æ˜¾ç¤ºæ‰€æœ‰çŸ­ä¿¡ | - | ç™»å½•åå¯æŸ¥çœ‹å…¨éƒ¨çŸ­ä¿¡ |
| `88888888` | å†…å®¹åŒ…å«å…³é”®è¯ | `åŒ—äº¬å¤§å­¦` | åªæ˜¾ç¤ºå†…å®¹åŒ…å«"åŒ—äº¬å¤§å­¦"çš„çŸ­ä¿¡ |
| `999999` | å‘é€è€…åŒ¹é… | `10086` | åªæ˜¾ç¤ºæ¥è‡ª10086çš„çŸ­ä¿¡ |

> ğŸ’¡ å­è´¦å·ç™»å½•åï¼Œæ‰€æœ‰çŸ­ä¿¡æŸ¥è¯¢éƒ½ä¼šè‡ªåŠ¨åº”ç”¨å¯¹åº”çš„ç­›é€‰è§„åˆ™ã€‚

### Docker å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs -f sms-server

# åœæ­¢å®¹å™¨
docker stop sms-server

# å¯åŠ¨å®¹å™¨
docker start sms-server

# é‡å¯å®¹å™¨
docker restart sms-server

# åˆ é™¤å®¹å™¨
docker rm -f sms-server
```

### API æ¥å£

#### è®¤è¯æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| POST | `/api/auth/login` | ç”¨æˆ·ç™»å½•ï¼ˆæ”¯æŒå­è´¦å·å¯†ç ï¼‰ | å¦ |
| POST | `/api/auth/change-password` | ä¿®æ”¹å¯†ç  | æ˜¯ |

#### çŸ­ä¿¡æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| GET | `/api/sms/conversations` | è·å–ä¼šè¯åˆ—è¡¨ï¼ˆè‡ªåŠ¨ç­›é€‰ï¼‰ | æ˜¯ |
| GET | `/api/sms/messages/:phone` | è·å–å¯¹è¯æ¶ˆæ¯ï¼ˆè‡ªåŠ¨ç­›é€‰ï¼‰ | æ˜¯ |
| GET | `/api/sms/list` | è·å–æ‰€æœ‰çŸ­ä¿¡ï¼ˆè‡ªåŠ¨ç­›é€‰ï¼‰ | æ˜¯ |
| POST | `/api/sms/send` | å‘é€çŸ­ä¿¡è¯·æ±‚ | æ˜¯ |
| GET | `/api/sms/outbox` | è·å–å‘ä»¶ç®± | æ˜¯ |
| POST | `/api/sms/receive` | è®¾å¤‡æ¨é€çŸ­ä¿¡ | å¦ |
| GET | `/api/sms/pending` | è®¾å¤‡è·å–å¾…å‘ä»»åŠ¡ | å¦ |
| POST | `/api/sms/sent` | è®¾å¤‡å›æŠ¥å‘é€ç»“æœ | å¦ |

#### ç®¡ç†å‘˜æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| GET | `/api/admin/status` | æ£€æŸ¥ç®¡ç†å‘˜æ˜¯å¦å·²åˆå§‹åŒ– | å¦ |
| POST | `/api/admin/init` | é¦–æ¬¡åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å· | å¦ |
| POST | `/api/admin/login` | ç®¡ç†å‘˜ç™»å½• | å¦ |
| POST | `/api/admin/change-password` | ä¿®æ”¹ç®¡ç†å‘˜å¯†ç  | ç®¡ç†å‘˜ |
| GET | `/api/admin/sub-accounts` | è·å–å­è´¦å·åˆ—è¡¨ | ç®¡ç†å‘˜ |
| POST | `/api/admin/sub-accounts` | æ·»åŠ å­è´¦å· | ç®¡ç†å‘˜ |
| PUT | `/api/admin/sub-accounts/:id` | æ›´æ–°å­è´¦å· | ç®¡ç†å‘˜ |
| DELETE | `/api/admin/sub-accounts/:id` | åˆ é™¤å­è´¦å· | ç®¡ç†å‘˜ |

---

## ğŸ“‚ æ–‡ä»¶è¯´æ˜

### sms-device/

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `main.lua` | ä¸»å…¥å£ï¼Œåˆå§‹åŒ–å’ŒçŸ­ä¿¡æ¥æ”¶å¤„ç† |
| `config.lua` | é…ç½®æ–‡ä»¶ |
| `util_notify.lua` | å¤šæ¸ é“é€šçŸ¥æ¨é€æ¨¡å— |
| `util_server.lua` | æœåŠ¡å™¨é€šä¿¡æ¨¡å— (æ¨é€çŸ­ä¿¡ã€è½®è¯¢å¾…å‘) |
| `lib_smtp.lua` | SMTP é‚®ä»¶å‘é€åº“ |
| `util_location.lua` | åŸºç«™å®šä½æ¨¡å— |
| `util_mobile.lua` | æ‰‹æœºå·/IMEI/è¿è¥å•†ä¿¡æ¯ |
| `util_netled.lua` | ç½‘ç»œçŠ¶æ€ LED æŒ‡ç¤º |
| `util_http.lua` | HTTP è¯·æ±‚å·¥å…· |

### sms-server/

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `server.js` | Express REST API + WebSocket æœåŠ¡ |
| `database.js` | SQLite æ•°æ®åº“æ“ä½œï¼ˆå«ç®¡ç†å‘˜/å­è´¦å·ï¼‰ |
| `public/index.html` | çŸ­ä¿¡ç•Œé¢å‰ç«¯é¡µé¢ |
| `public/style.css` | iOS é£æ ¼æ ·å¼è¡¨ |
| `public/app.js` | çŸ­ä¿¡ç•Œé¢äº¤äº’é€»è¾‘ |
| `public/admin.html` | ç®¡ç†å‘˜æ§åˆ¶å°é¡µé¢ |
| `public/admin.css` | ç®¡ç†å‘˜ç•Œé¢ä¸“ç”¨æ ·å¼ |
| `public/admin.js` | ç®¡ç†å‘˜ç•Œé¢äº¤äº’é€»è¾‘ |
| `public/manifest.json` | PWA é…ç½® |
| `public/logo.png` | åº”ç”¨å›¾æ ‡ |

---

## ğŸ”„ å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     çŸ­ä¿¡æ¨é€      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     ç½‘é¡µæŸ¥çœ‹
â”‚  Air780E    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  Web æœåŠ¡å™¨  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç”¨æˆ·
â”‚  è®¾å¤‡ç«¯     â”‚                   â”‚  (Docker)   â”‚
â”‚             â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç”¨æˆ·
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    è½®è¯¢å¾…å‘ä»»åŠ¡    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    å‘é€çŸ­ä¿¡è¯·æ±‚
       â”‚                                â”‚
       â”‚          å‘é€çŸ­ä¿¡              â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

1. **æ”¶çŸ­ä¿¡**: è®¾å¤‡æ”¶åˆ°çŸ­ä¿¡ â†’ æ¨é€åˆ°æœåŠ¡å™¨ â†’ WebSocket å®æ—¶é€šçŸ¥ç½‘é¡µ
2. **å‘çŸ­ä¿¡**: ç”¨æˆ·åœ¨ç½‘é¡µæäº¤ â†’ æœåŠ¡å™¨æ ‡å‡†åŒ–å·ç å¹¶å­˜å…¥é˜Ÿåˆ— â†’ è®¾å¤‡è½®è¯¢è·å– â†’ è®¾å¤‡å‘é€ â†’ å›æŠ¥ç»“æœ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æµé‡æ¶ˆè€—**: æ¯æ¡é€šçŸ¥ä¼šæ¶ˆè€—ç§»åŠ¨ç½‘ç»œæµé‡ï¼Œå»ºè®®ä½¿ç”¨ç‰©è”ç½‘å¡
2. **å®‰å…¨æ€§**: ç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹é»˜è®¤å¯†ç ï¼Œå»ºè®®é…ç½® HTTPS
3. **é˜²ç«å¢™**: ç¡®ä¿æœåŠ¡å™¨ 3000 ç«¯å£å¯¹å¤–å¼€æ”¾
4. **æ—¶åŒº**: Docker å®¹å™¨å·²é…ç½®ä¸º `Asia/Shanghai` æ—¶åŒº
5. **æ‰‹æœºå·æ ¼å¼**: ç³»ç»Ÿè‡ªåŠ¨å°†å„ç§æ ¼å¼è½¬æ¢ä¸º `+86XXXXXXXXXXX` æ ‡å‡†æ ¼å¼

---

## æ–‡ä»¶ç›®å½•ç»“æ„åŠè¯´æ˜

### 1. ç¡¬ä»¶ç«¯ (sms-device)

åŸºäº LuatOS å¼€å‘ï¼Œè´Ÿè´£çŸ­ä¿¡æ¥æ”¶ã€ç½‘ç»œè¿æ¥å’Œå¤šç§æ¸ é“çš„é€šçŸ¥ã€‚

- **[main.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/main.lua)**: é¡¹ç›®å…¥å£æ–‡ä»¶ã€‚è´Ÿè´£ç³»ç»Ÿåˆå§‹åŒ–ã€ç¡¬ä»¶æ§åˆ¶ï¼ˆçœ‹é—¨ç‹—ã€æŒ‰é”®ï¼‰ã€çŸ­ä¿¡å›è°ƒæ³¨å†Œä»¥åŠå¯åŠ¨å„ä¸ªåŠŸèƒ½ä»»åŠ¡ã€‚
- **[config.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/config.lua)**: å…¨å±€é…ç½®æ–‡ä»¶ã€‚åŒ…å«äº†é€šçŸ¥æ¸ é“è®¾ç½®ã€API åœ°å€ã€SMTP é…ç½®ã€å®šä½é—´éš”ç­‰å‚æ•°ã€‚
- **[util_notify.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/util_notify.lua)**: æ ¸å¿ƒé€šçŸ¥æ¨¡å—ã€‚æ”¯æŒ Telegram, SMTP, Bark, Gotify, DingTalk ç­‰å¤šç§æ¨é€æ–¹å¼ï¼Œå¹¶å®ç°äº†å¤±è´¥é‡è¯•çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚
- **[util_server.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/util_server.lua)**: ä¸åç«¯æœåŠ¡å™¨é€šä¿¡çš„æ¨¡å—ã€‚è´Ÿè´£ä»æœåŠ¡å™¨è·å–å¾…å‘é€çŸ­ä¿¡ï¼ˆOutboxï¼‰å¹¶ä¸ŠæŠ¥å‘é€ç»“æœã€‚
- **[util_mobile.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/util_mobile.lua)**: ç§»åŠ¨ç½‘ç»œå·¥å…·ç±»ã€‚ç”¨äºè·å–è¿è¥å•†ä¿¡æ¯ã€ä¿¡å·å¼ºåº¦ã€æµé‡ç»Ÿè®¡ç­‰ã€‚
- **[util_location.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/util_location.lua)**: åœ°ç†ä½ç½®æ¨¡å—ã€‚é€šè¿‡åŸºç«™ä¿¡æ¯è¿›è¡Œå®šä½ï¼Œå¹¶è¿”å›åœ°å›¾é“¾æ¥ã€‚
- **[util_netled.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/util_netled.lua)**: ç½‘ç»œæŒ‡ç¤ºç¯æ§åˆ¶ã€‚é€šè¿‡é—ªçƒé¢‘ç‡åé¦ˆç½‘ç»œçŠ¶æ€ï¼ˆæœªè”ç½‘ã€å·²è”ç½‘ï¼‰ã€‚
- **[util_http.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/util_http.lua)**: HTTP è¯·æ±‚å°è£…åº“ã€‚æä¾›åŸºç¡€çš„ GET/POST æ“ä½œã€‚
- **[lib_smtp.lua](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-device/lib_smtp.lua)**: SMTP åè®®å®ç°ã€‚ç”¨äºé€šè¿‡é‚®ä»¶æœåŠ¡å™¨å‘é€çŸ­ä¿¡å†…å®¹ã€‚

### 2. æœåŠ¡å™¨ç«¯ (sms-server)

åŸºäº Node.js Express æ¡†æ¶ï¼Œæä¾›çŸ­ä¿¡å­˜å‚¨ã€ç½‘é¡µæŸ¥çœ‹å’Œè½¬å‘ä»»åŠ¡ç®¡ç†ã€‚

- **[server.js](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-server/server.js)**: åç«¯ä¸»è¿›ç¨‹ã€‚å¤„ç† RESTful APIï¼ˆç™»å½•ã€çŸ­ä¿¡æ¥æ”¶ã€ä¼šè¯åˆ—è¡¨ã€å‘é€è¯·æ±‚ï¼‰å’Œ WebSocket å®æ—¶æ¨é€ã€‚
- **[database.js](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-server/database.js)**: æ•°æ®åº“æ“ä½œå±‚ã€‚ä½¿ç”¨ SQLite å­˜å‚¨çŸ­ä¿¡å†…å®¹ã€è®¾ç½®åŠå¾…å‘é€é˜Ÿåˆ—ã€‚
- **public/**: å‰ç«¯é™æ€èµ„æºç›®å½•ã€‚åŒ…å«ç½‘é¡µç•Œé¢é€»è¾‘ï¼ˆé€šå¸¸æ˜¯ HTML/JS/CSSï¼‰ã€‚
- **[Dockerfile](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-server/Dockerfile)**: Docker é•œåƒé…ç½®æ–‡ä»¶ï¼Œæ–¹ä¾¿ä¸€é”®éƒ¨ç½²ã€‚
- **[docker-compose.yml](file:///c:/Users/Administrator/Downloads/SMS-Forwarder/sms-server/docker-compose.yml)**: Docker ç¼–æ’é…ç½®ï¼Œå®šä¹‰æœåŠ¡å®¹å™¨åŠå…¶æ•°æ®å·æŒ‚è½½ã€‚

---

## ä»£ç å®¡æŸ¥å»ºè®®

1. **å®‰å…¨æ€§**:
   - `server.js` ä¸­ä½¿ç”¨äº†ç®€å•çš„é™æ€å¯†ç ï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒå¢åŠ å¯†ç å“ˆå¸Œå­˜å‚¨ã€‚
   - `config.lua` ä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆToken, å¯†ç ï¼‰ï¼Œåº”æé†’ç”¨æˆ·ä¿æŠ¤æ­¤æ–‡ä»¶æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆåœ¨æœåŠ¡å™¨ç«¯ï¼‰ã€‚

2. **å¥å£®æ€§**:
   - `util_notify.lua` å·²ç»å®ç°äº†é‡è¯•æœºåˆ¶ï¼Œéå¸¸ä¼˜ç§€ã€‚ä½†åœ¨æç«¯å¼±ç½‘ç¯å¢ƒä¸‹ï¼Œå¯ä»¥è€ƒè™‘æŒä¹…åŒ–å­˜å‚¨å¾…å‘æ¶ˆæ¯ã€‚
   - `database.js` åº”è¯¥åœ¨å¯åŠ¨æ—¶æ£€æŸ¥å¹¶åˆ›å»º `data` ç›®å½•ï¼ˆå·²å®ç°ï¼‰ã€‚

3. **å¯ç»´æŠ¤æ€§**:
   - ç›®å‰æ³¨é‡Šè¾ƒä¸ºè¯¦å°½ï¼Œä½†åœ¨æŸäº›å¤æ‚çš„é€»è¾‘å—ï¼ˆå¦‚ `lib_smtp.lua`ï¼‰å¯ä»¥å¢åŠ æ›´è¯¦ç»†çš„åè®®è§£é‡Šã€‚
   - å»ºè®®å¢åŠ æ—¥å¿—åˆ†çº§ç®¡ç†ï¼Œé¿å…ç”Ÿäº§ç¯å¢ƒè¾“å‡ºè¿‡å¤šè°ƒè¯•ä¿¡æ¯ã€‚

## ï¿½ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹é¡¹ç›®äºŒæ¬¡å¼€å‘ï¼š

- [ã€è§£å†³æ–¹æ¡ˆã€‘åˆå®™air780eç¡¬ä»¶å®ç°çŸ­ä¿¡è½¬å‘ æœ€ç»ˆç‰ˆæœ¬](https://www.yuque.com/pengzhiqiang999/xiaokenai/bhzrqf68i9i07qac) - æ„Ÿè°¢ @pengzhiqiang999 æä¾›çš„åŸå§‹æ–¹æ¡ˆ

---

## ï¿½ğŸ“„ è®¸å¯è¯

MIT License
